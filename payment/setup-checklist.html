<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 15px;
        }
        .step {
            margin: 25px 0;
            padding: 20px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            position: relative;
        }
        .step.completed {
            border-color: #27ae60;
            background: #f8fff8;
        }
        .step-number {
            position: absolute;
            top: -15px;
            left: 20px;
            background: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .step.completed .step-number {
            background: #27ae60;
        }
        .step-title {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            margin-left: 20px;
        }
        .checklist {
            list-style: none;
            padding: 0;
            margin-left: 20px;
        }
        .checklist li {
            margin: 8px 0;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #3498db;
        }
        .checklist li.completed {
            background: #d4edda;
            border-left-color: #27ae60;
            text-decoration: line-through;
            color: #6c757d;
        }
        .checkbox {
            margin-right: 10px;
            transform: scale(1.2);
        }
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            margin: 10px 0;
            white-space: pre-wrap;
            overflow-x: auto;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            text-decoration: none;
            display: inline-block;
        }
        .btn:hover {
            background: #2980b9;
        }
        .btn.success {
            background: #27ae60;
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #27ae60);
            width: 0%;
            transition: width 0.3s ease;
        }
        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
            color: #2c3e50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ æ±ºæ¸ˆã‚·ã‚¹ãƒ†ãƒ  Google Sheetsé€£æº ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</h1>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>
        <div class="progress-text" id="progressText">0% å®Œäº†</div>

        <!-- Step 1: Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ -->
        <div class="step" id="step1">
            <div class="step-number">1</div>
            <div class="step-title">ğŸ“Š Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆä½œæˆ</div>
            <ul class="checklist">
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> Google Sheetsã§æ–°ã—ã„ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> ã‚¿ã‚¤ãƒˆãƒ«ã‚’ã€Œæ³¨æ–‡ç®¡ç†ã€ã«å¤‰æ›´</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> A1ã‹ã‚‰X1ã¾ã§ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’è¨­å®š</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> ã‚·ãƒ¼ãƒˆåã‚’ã€ŒOrdersã€ã«å¤‰æ›´</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã‚’URLã‹ã‚‰å–å¾—ãƒ»ä¿å­˜</li>
            </ul>
            <div class="code-block">URLã®ä¾‹:
https://docs.google.com/spreadsheets/d/ã€ã“ã“ãŒã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆIDã€‘/edit</div>
        </div>

        <!-- Step 2: Google Apps Script -->
        <div class="step" id="step2">
            <div class="step-number">2</div>
            <div class="step-title">âš™ï¸ Google Apps Scriptè¨­å®š</div>
            <ul class="checklist">
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> script.google.comã§æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’ã€Œæ³¨æ–‡ãƒ‡ãƒ¼ã‚¿å—ä¿¡ã€ã«å¤‰æ›´</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> æä¾›ã•ã‚ŒãŸJavaScriptã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€å®Ÿè¡Œ</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã¨ã—ã¦è¨­å®šï¼ˆå®Ÿè¡Œè€…:è‡ªåˆ†ã€ã‚¢ã‚¯ã‚»ã‚¹:å…¨å“¡ï¼‰</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> èªè¨¼ã‚’å®Œäº†</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> Web App URLã‚’å–å¾—ãƒ»ä¿å­˜</li>
            </ul>
        </div>

        <!-- Step 3: PHPè¨­å®š -->
        <div class="step" id="step3">
            <div class="step-number">3</div>
            <div class="step-title">ğŸ”§ PHPè¨­å®šæ›´æ–°</div>
            <ul class="checklist">
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> config.phpã‚’é–‹ã</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> GOOGLE_SPREADSHEET_IDã‚’å®Ÿéš›ã®IDã«å¤‰æ›´</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> GOOGLE_APPS_SCRIPT_URLã‚’å®Ÿéš›ã®URLã«å¤‰æ›´</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> AUTHORIZENET_ENVIRONMENTãŒ'SANDBOX'ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª</li>
            </ul>
            <div class="code-block">config.phpæ›´æ–°ä¾‹:
define('GOOGLE_SPREADSHEET_ID', 'ã‚ãªãŸã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆID');
define('GOOGLE_APPS_SCRIPT_URL', 'ã‚ãªãŸã®Web App URL');</div>
        </div>

        <!-- Step 4: Authorize.Netè¨­å®š -->
        <div class="step" id="step4">
            <div class="step-number">4</div>
            <div class="step-title">ğŸ’³ Authorize.Net SANDBOXè¨­å®š</div>
            <ul class="checklist">
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> developer.authorize.netã§SANDBOXã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> API Login IDã‚’å–å¾—</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> Transaction Keyã‚’å–å¾—</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> Public Client Keyã‚’å–å¾—</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> config.phpã®èªè¨¼æƒ…å ±ã‚’æ›´æ–°</li>
            </ul>
        </div>

        <!-- Step 5: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ -->
        <div class="step" id="step5">
            <div class="step-number">5</div>
            <div class="step-title">ğŸ§ª ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</div>
            <ul class="checklist">
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> setup-test.phpã«ã‚¢ã‚¯ã‚»ã‚¹</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> è¨­å®šçŠ¶æ³ç¢ºèªã§å…¨ã¦âœ…ã«ãªã‚‹ã“ã¨ã‚’ç¢ºèª</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> Apps Scriptå‹•ä½œãƒ†ã‚¹ãƒˆæˆåŠŸ</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿é€ä¿¡æˆåŠŸ</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª</li>
            </ul>
            <a href="setup-test.php" class="btn" target="_blank">setup-test.phpã‚’é–‹ã</a>
        </div>

        <!-- Step 6: æ±ºæ¸ˆãƒ†ã‚¹ãƒˆ -->
        <div class="step" id="step6">
            <div class="step-number">6</div>
            <div class="step-title">ğŸ’° æ±ºæ¸ˆãƒ†ã‚¹ãƒˆ</div>
            <ul class="checklist">
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> index.phpã«ã‚¢ã‚¯ã‚»ã‚¹</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> ãƒ•ã‚©ãƒ¼ãƒ ã«é©å½“ãªæƒ…å ±ã‚’å…¥åŠ›</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> ãƒ†ã‚¹ãƒˆã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ï¼ˆ4111111111111111ï¼‰ã§æ±ºæ¸ˆ</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> æ±ºæ¸ˆæˆåŠŸç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«æ±ºæ¸ˆãƒ‡ãƒ¼ã‚¿ãŒè¿½åŠ ã•ã‚Œã‚‹</li>
                <li><input type="checkbox" class="checkbox" onchange="updateProgress()"> ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãå…¥åŠ›ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª</li>
            </ul>
            <div class="warning">
                <strong>ãƒ†ã‚¹ãƒˆç”¨ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰æƒ…å ±:</strong><br>
                ã‚«ãƒ¼ãƒ‰ç•ªå·: 4111111111111111<br>
                æœ‰åŠ¹æœŸé™: 12/25ï¼ˆå°†æ¥ã®æ—¥ä»˜ï¼‰<br>
                CVV: 123<br>
                åå‰: Test User
            </div>
            <a href="index.php" class="btn" target="_blank">æ±ºæ¸ˆãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ã</a>
        </div>

        <!-- å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
        <div id="completionMessage" style="display: none;">
            <div class="success">
                <h2>ğŸ‰ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†ï¼</h2>
                <p>ã™ã¹ã¦ã®ã‚¹ãƒ†ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã—ãŸã€‚æ±ºæ¸ˆã‚·ã‚¹ãƒ†ãƒ ã¨Google Sheetsã®é€£æºãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ã€‚</p>
                <ul>
                    <li>âœ… æ±ºæ¸ˆå‡¦ç†ãŒæ­£å¸¸ã«å‹•ä½œ</li>
                    <li>âœ… ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ã®ãƒ‡ãƒ¼ã‚¿è»¢é€ãŒå‹•ä½œ</li>
                    <li>âœ… æœ¬ç•ªé‹ç”¨ã®æº–å‚™å®Œäº†</li>
                </ul>
                <p><strong>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:</strong></p>
                <ul>
                    <li>æœ¬ç•ªç’°å¢ƒã«ç§»è¡Œã™ã‚‹å ´åˆã¯ã€AUTHORIZENET_ENVIRONMENTã‚’'PRODUCTION'ã«å¤‰æ›´</li>
                    <li>å®Ÿéš›ã®Authorize.Netæœ¬ç•ªèªè¨¼æƒ…å ±ã«æ›´æ–°</li>
                    <li>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã®ç¢ºèª</li>
                </ul>
            </div>
        </div>

        <!-- ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° -->
        <div class="step">
            <div class="step-number">â“</div>
            <div class="step-title">ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</div>
            <div style="margin-left: 20px;">
                <h4>ã‚ˆãã‚ã‚‹å•é¡Œ:</h4>
                <ul>
                    <li><strong>Apps Scriptèªè¨¼ã‚¨ãƒ©ãƒ¼:</strong> ã€Œè©³ç´°è¨­å®šã€â†’ã€Œå®‰å…¨ã§ãªã„ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã€ã‚’é¸æŠ</li>
                    <li><strong>ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ãƒ‡ãƒ¼ã‚¿ãŒå…¥ã‚‰ãªã„:</strong> URLã‚„IDã®è¨­å®šã‚’å†ç¢ºèª</li>
                    <li><strong>æ±ºæ¸ˆèªè¨¼ã‚¨ãƒ©ãƒ¼:</strong> Authorize.Net SANDBOXèªè¨¼æƒ…å ±ã‚’ç¢ºèª</li>
                    <li><strong>æ±ºæ¸ˆæˆåŠŸã ãŒã‚·ãƒ¼ãƒˆæœªåæ˜ :</strong> authorize-credit-card.php:342è¡Œç›®ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’ç¢ºèª</li>
                </ul>
                
                <h4>ãƒ‡ãƒãƒƒã‚°ãƒ„ãƒ¼ãƒ«:</h4>
                <a href="setup-test.php" class="btn">è¨­å®šãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸</a>
                <a href="test-tools/sheets/test-data-sender.php" class="btn">ãƒ‡ãƒ¼ã‚¿é€ä¿¡ãƒ†ã‚¹ãƒˆ</a>
            </div>
        </div>
    </div>

    <script>
        function updateProgress() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const totalCheckboxes = checkboxes.length;
            let checkedCount = 0;

            checkboxes.forEach((checkbox, index) => {
                const listItem = checkbox.parentElement;
                if (checkbox.checked) {
                    listItem.classList.add('completed');
                    checkedCount++;
                } else {
                    listItem.classList.remove('completed');
                }
            });

            // ã‚¹ãƒ†ãƒƒãƒ—ã®å®Œäº†çŠ¶æ…‹ã‚’æ›´æ–°
            for (let i = 1; i <= 6; i++) {
                const step = document.getElementById(`step${i}`);
                const stepCheckboxes = step.querySelectorAll('input[type="checkbox"]');
                const stepChecked = Array.from(stepCheckboxes).every(cb => cb.checked);
                
                if (stepChecked) {
                    step.classList.add('completed');
                } else {
                    step.classList.remove('completed');
                }
            }

            // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’æ›´æ–°
            const percentage = Math.round((checkedCount / totalCheckboxes) * 100);
            document.getElementById('progressBar').style.width = percentage + '%';
            document.getElementById('progressText').textContent = percentage + '% å®Œäº†';

            // å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            if (percentage === 100) {
                document.getElementById('completionMessage').style.display = 'block';
                // ãƒšãƒ¼ã‚¸ã®ä¸€ç•ªä¸‹ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
                setTimeout(() => {
                    document.getElementById('completionMessage').scrollIntoView({ 
                        behavior: 'smooth' 
                    });
                }, 500);
            } else {
                document.getElementById('completionMessage').style.display = 'none';
            }
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸçŠ¶æ…‹ã‚’è¨­å®š
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
        });
    </script>
</body>
</html>